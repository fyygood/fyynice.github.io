<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¥­æ­ªæ­ª - æ—¥å¿—</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="header-left">
            <img src="images/image1.jpg" alt="å¤´åƒ" class="header-avatar">
            <h1>é¥­æ­ªæ­ª</h1>
            <span class="house-icon">ğŸ </span>
        </div>
        <nav class="header-nav">
            <a href="index.html" class="nav-item">é¦–é¡µ</a>
            <a href="log.html" class="nav-item active">æ—¥å¿—</a>
            <a href="todo.html" class="nav-item">to do</a>
            <a href="growth.html" class="nav-item">æˆé•¿</a>
            <a href="thought.html" class="nav-item">æ€è€ƒ</a>
        </nav>
    </header>

    <main class="log-main">
        <aside class="log-sidebar">
            <div class="date-list" id="date-list">
                <!-- æ—¥æœŸåˆ—è¡¨å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </aside>
        <div class="log-content">
            <div class="markdown-container" id="markdown-content">
                <p>markdown æ–‡ä»¶</p>
            </div>
        </div>
    </main>

    <script src="js/marked.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        // ç”Ÿæˆæ—¥æœŸåˆ—è¡¨ï¼ˆä»2025.12.29å¼€å§‹ï¼Œåªæ˜¾ç¤ºåˆ°ä»Šå¤©çš„æ—¥æœŸï¼‰
        function generateDateList() {
            const dateList = document.getElementById('date-list');
            const startDate = new Date('2025-12-29');
            const today = new Date();
            today.setHours(23, 59, 59, 999); // è®¾ç½®ä¸ºä»Šå¤©çš„æœ€åä¸€åˆ»ï¼Œç¡®ä¿åŒ…å«ä»Šå¤©
            
            // ç”Ÿæˆä»å¼€å§‹æ—¥æœŸåˆ°ä»Šå¤©ï¼ˆåŒ…å«ä»Šå¤©ï¼‰çš„æ—¥æœŸåˆ—è¡¨
            const dates = [];
            const currentDate = new Date(startDate);
            
            while (currentDate <= today) {
                dates.push(new Date(currentDate));
                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            // æŒ‰æ—¥æœŸå€’åºæ’åˆ—ï¼ˆæœ€æ–°çš„æ—¥æœŸåœ¨æœ€ä¸Šé¢ï¼‰
            dates.reverse();
            
            // è·å–ä»Šå¤©çš„æ—¥æœŸå­—ç¬¦ä¸²
            const todayYear = today.getFullYear();
            const todayMonth = String(today.getMonth() + 1).padStart(2, '0');
            const todayDay = String(today.getDate()).padStart(2, '0');
            const todayDateStr = `${todayYear}.${todayMonth}.${todayDay}`;
            
            // æ˜ŸæœŸå‡ çš„ä¸­æ–‡æ•°ç»„
            const weekdays = ['å‘¨æ—¥', 'å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­'];
            
            let todayItem = null; // ç”¨äºä¿å­˜ä»Šå¤©çš„æ—¥æœŸé¡¹
            let currentMonth = null; // ç”¨äºè·Ÿè¸ªå½“å‰æœˆä»½ï¼Œç”¨äºåˆ†ç»„æ˜¾ç¤º
            
            dates.forEach(date => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                const dateStr = `${year}.${month}.${day}`;
                const weekday = weekdays[date.getDay()]; // è·å–æ˜ŸæœŸå‡ 
                
                // å¦‚æœæ˜¯æ–°çš„æœˆä»½ï¼Œæ·»åŠ æœˆä»½æ ‡é¢˜
                const monthKey = `${year}.${month}`;
                if (currentMonth !== monthKey) {
                    currentMonth = monthKey;
                    const monthHeader = document.createElement('div');
                    monthHeader.className = 'date-month-header';
                    monthHeader.textContent = `${year}å¹´${parseInt(month)}æœˆ`;
                    dateList.appendChild(monthHeader);
                }
                
                const dateItem = document.createElement('div');
                dateItem.className = 'date-item';
                // æ˜¾ç¤ºæ ¼å¼ï¼šæ—¥æœŸ + æ˜ŸæœŸå‡ ï¼Œä¾‹å¦‚ï¼š12.29 å‘¨ä¸€
                dateItem.textContent = `${month}.${day} ${weekday}`;
                dateItem.setAttribute('data-date', dateStr); // æ·»åŠ data-dateå±æ€§ï¼Œç”¨äºåŠ è½½æ–‡ä»¶
                dateItem.setAttribute('title', dateStr); // æ·»åŠ å®Œæ•´æ—¥æœŸä½œä¸ºæç¤º
                
                // å¦‚æœæ˜¯ä»Šå¤©çš„æ—¥æœŸï¼Œä¿å­˜å¼•ç”¨
                if (dateStr === todayDateStr) {
                    todayItem = dateItem;
                }
                
                dateItem.addEventListener('click', function() {
                    // ç§»é™¤ä¹‹å‰çš„æ¿€æ´»çŠ¶æ€
                    document.querySelectorAll('.date-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // æ·»åŠ å½“å‰æ¿€æ´»çŠ¶æ€
                    this.classList.add('active');
                    
                    // åŠ è½½ Markdown æ–‡ä»¶
                    loadMarkdown('markdown/log/' + dateStr + '.md');
                });
                dateList.appendChild(dateItem);
            });
            
            // é»˜è®¤åŠ è½½ä»Šå¤©çš„æ—¥æœŸ
            if (todayItem) {
                // æ¿€æ´»ä»Šå¤©çš„æ—¥æœŸé¡¹
                todayItem.classList.add('active');
                // åŠ è½½ä»Šå¤©çš„ Markdown æ–‡ä»¶
                loadMarkdown('markdown/log/' + todayDateStr + '.md');
                // æ»šåŠ¨åˆ°ä»Šå¤©çš„æ—¥æœŸé¡¹ï¼ˆå¯é€‰ï¼Œè®©ç”¨æˆ·èƒ½çœ‹åˆ°é€‰ä¸­çš„é¡¹ï¼‰
                todayItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        function loadMarkdown(path) {
            fetch(path)
                .then(response => {
                    if (!response.ok) throw new Error('æ–‡ä»¶ä¸å­˜åœ¨');
                    return response.text();
                })
                .then(text => {
                    document.getElementById('markdown-content').innerHTML = marked.parse(text);
                })
                .catch(error => {
                    document.getElementById('markdown-content').innerHTML = '<p>markdown æ–‡ä»¶</p>';
                });
        }
        
        generateDateList();
    </script>
</body>
</html>

